<html>
<head>
<meta charset="utf-8">


<title>Working with Kotlin and JavaScript Modules - Kotlin Programming Language</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<link rel="Shortcut Icon" href="/kotlin-web-site-ja/assets/images/favicon.ico" type="image/x-icon"/>
<link rel="apple-touch-icon" href="/kotlin-web-site-ja/assets/images/apple-touch-icon.png"/>
<link rel="apple-touch-icon" sizes="72x72"
      href="/kotlin-web-site-ja/assets/images/apple-touch-icon-72x72.png"/>
<link rel="apple-touch-icon" sizes="114x114"
      href="/kotlin-web-site-ja/assets/images/apple-touch-icon-114x114.png"/>
<link rel="apple-touch-icon" sizes="144x144"
      href="/kotlin-web-site-ja/assets/images/apple-touch-icon-144x144.png"/>
<link rel="stylesheet" href="/kotlin-web-site-ja/_assets/styles.css">


<!-- Social Media tag Starts -->
<!-- Place this data between the <head> tags of your website -->
<!-- Open Graph data -->
<meta property="og:title" content="Working with Kotlin and JavaScript Modules - Kotlin Programming Language"/>
<meta property="og:type" content="website"/>
<meta property="og:url" content="https://kotlinlang.org/docs/tutorials/javascript/working-with-modules/working-with-modules.html"/>
<meta property="og:image" content="https://kotlinlang.org/assets/images/open-graph/kotlin_250x250.png"/>
    <meta property="og:description" content="A look at how to use Kotlin to interact with JavaScript modules.">
<meta property="og:site_name" content="Kotlin"/>

<!-- Twitter Card data -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@kotlin">
<meta name="twitter:title" content="Working with Kotlin and JavaScript Modules - Kotlin Programming Language">
    <meta name="twitter:description" content="A look at how to use Kotlin to interact with JavaScript modules.">
<meta name="twitter:image:src" content="https://kotlinlang.org/assets/images/twitter-card/kotlin_800x320.png">
<!-- Social Media tag Ends -->    <script src="/kotlin-web-site-ja/_assets/default.js"></script>
    <script src="/kotlin-web-site-ja/_assets/common.js"></script>
</head>
<body>
<!--Google Analytics-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-88424767-1', 'auto');
  ga('send', 'pageview');

</script>
<!--/Google Analytics-->
<div class="global-layout">

<header class="global-header">

    <div class="global-header-panel">
        <div class="g-layout">
            <a class="global-header-logo" href="/kotlin-web-site-ja/">Kotlin</a>
<nav role="navigation" class="global-nav">

    <div class="nav-links">

            <a href="/kotlin-web-site-ja/docs/reference/"
               class="nav-item "
            >
                Learn
            </a>

            <a href="/kotlin-web-site-ja/contribute.html"
               class="nav-item "
            >
                Contribute
            </a>

            <a href="http://try.kotlinlang.org"
               class="nav-item "
            >
                Try Online
            </a>
    </div>


<div id="global-search" class=" global-search" title="Search">
    <div class="search-button">
        <div class="icon"></div>
    </div>
    <div class="search-box">
        <div class="gcse-searchbox-only"
             data-resultsUrl="/search.html"
             data-newWindow="false"
        ></div>
    </div>
</div></nav>        </div>
    </div>

    <div class="g-layout">
    </div>
</header>
    <div class="g-layout global-content">
    <div class="g-grid">

        <div class="g-12">
<nav role="navigation" class="docs-nav">
        <div class="nav-item-wrap">
                <a href="/kotlin-web-site-ja/docs/reference/" class="nav-item">
                    <span class="nav-item-text">
                        リファレンス
                    </span>
                </a>

        </div>
        <div class="nav-item-wrap">
                <a href="/kotlin-web-site-ja/docs/tutorials/" class="nav-item is_active">
                        <span class="nav-item-text">
                            Tutorials
                        </span>
                </a>
        </div>
        <div class="nav-item-wrap">
                <a href="/kotlin-web-site-ja/docs/videos.html" class="nav-item">
                    <span class="nav-item-text">
                        Videos
                    </span>
                </a>

        </div>
        <div class="nav-item-wrap">
                <a href="/kotlin-web-site-ja/docs/events.html" class="nav-item">
                    <span class="nav-item-text">
                        Events
                    </span>
                </a>

        </div>
        <div class="nav-item-wrap">
                <a href="/kotlin-web-site-ja/docs/resources.html" class="nav-item">
                    <span class="nav-item-text">
                        More resources
                    </span>
                </a>

        </div>
</nav>        </div>

        <aside class="g-3">
            <div id="tutorials-nav">
                    <nav role="navigation" class="side-tree-nav">
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="Getting Started">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">Getting Started</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/getting-started.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Getting Started with IntelliJ IDEA</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/getting-started-eclipse.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Getting Started with Eclipse</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/command-line.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Working with the Command Line Compiler</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/build-tools.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Working with Build Tools</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/koans.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Koans</span>
                            </a>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="Java Interop">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">Java Interop</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/mixing-java-kotlin-intellij.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Mixing Java and Kotlin in one project</span>
                            </a>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _opened"
                 data-id="JavaScript">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">JavaScript</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/javascript/kotlin-to-javascript/kotlin-to-javascript.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Kotlin to JavaScript</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/javascript/getting-started-idea/getting-started-with-intellij-idea.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Getting Started with Kotlin and JavaScript with IntelliJ IDEA</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <div class="tree-item-title tree-leaf-title js-item-title js-leaf-title is_active">
                                <div class="marker"></div>
                                <div class="text">Working with Kotlin and JavaScript Modules</div>
                            </div>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/javascript/getting-started-command-line/command-line-library-js.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Creating a Kotlin JavaScript library with the Command Line Compiler</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/javascript/getting-started-maven/getting-started-with-maven.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Getting Started with Kotlin and JavaScript with Maven</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/javascript/getting-started-gradle/getting-started-with-gradle.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Getting Started with Kotlin and JavaScript with Gradle</span>
                            </a>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="Web Development">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">Web Development</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/httpservlets.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Creating Web Applications with Http Servlets</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/spring-boot-restful.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Creating a RESTful Web Service with Spring Boot</span>
                            </a>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="Mobile">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">Mobile</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/kotlin-android.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Getting Started With Android Development</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/android-plugin.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Kotlin Android Extensions</span>
                            </a>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="Tools">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">Tools</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/kotlin-web-site-ja/docs/tutorials/kotlin-and-ci.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Setting up Kotlin on TeamCity</span>
                            </a>
                    </div>

            </div>
    </nav>

            </div>
        </aside>

        <article role="main" class="page-content g-9">
<a href="https://github.com/dogwood008/kotlin-web-site-ja/edit/master/pages/docs/tutorials/javascript/working-with-modules/working-with-modules.md"
   class="page-link-to-github"
   target="_blank"
   title="Edit this page on GitHub">
        <i class="github-icon"></i>
        <span class="text">Edit Page</span>
</a>
            <h1>
                Working with Kotlin and JavaScript Modules
            </h1>
            <table>
                    <tr>
                        <td>
                            <strong>Last Updated</strong>
                        </td>
                        <td>
                            30 September 2016
                        </td>
                    </tr>
            </table>
                A look at how to use Kotlin to interact with JavaScript modules.
                <br/>
                <br/>
            
<p>In this tutorial we'll see how to</p>
<ul>
<li><a href="#ConfiguringModulesWithIntelliJIDEA">Configure modules when using IntelliJ IDEA</a></li>
<li><a href="#ConfiguringModulesWithMavenOrGradle">Configure modules when using Maven or Gradle</a></li>
<li><a href="#UsingAMD">Use Kotlin in the browser with AMD</a></li>
<li><a href="#UsingCommonJS">Use Kotlin from node.js with CommonJS</a></li>
</ul>
<h2 id="configuring-modules-with-intellij-idea">Configuring Modules with IntelliJ IDEA</h2>
<p>Kotlin generate JavaScript code that is compatible with Asynchronous Module Definition (AMD), CommonJS and Universal Model Definition (UMD).</p>
<ul>
<li><strong>AMD</strong> is usually used on the client-side in the browser. The idea behind AMD is to load modules asynchronously, thus improving usability and performance.</li>
<li><strong>CommonJS</strong> is the module system used on the server-side, and in particular with node.js. Node modules all abide by this definition. CommonJS modules can also be used in the browser via <a href="http://browserify.org/">Browserify</a>.</li>
<li><strong>UMD</strong> tries to unify both models allowing these to be used either on the client or server.</li>
</ul>
<p>We can configure the Kotlin compiler option to use any of these. The last option (UMD) will generate UMD and fallback to the other options if one is not available.
Currently Kotlin compiler options are per IntelliJ IDEA project as opposed to a Kotlin module.</p>
<p><img alt="Kotlin Compiler Options" src="/kotlin-web-site-ja/assets/images/tutorials/javascript/working-with-modules/kotlin-compiler.png"/></p>
<h2 id="configuring-modules-when-using-maven-or-gradle">Configuring Modules when using Maven or Gradle</h2>
<p>If using Maven or Gradle, we can also configure the module output format. For more information see <a href="http://kotlinlang.org/docs/reference/js-modules.html">JavaScript Modules</a>.</p>
<h2 id="using-amd">Using AMD</h2>
<p>When using AMD, we set the compiler option to use AMD. Once we do that, we can then reference any modules that we've defined as if they were regular AMD ones.</p>
<p>For instance, given</p>
<pre><code class="code _highlighted" data-lang="text/x-kotlin">class Customer(val id: Int, val name: String, val email: String) {
    var isPreferred = false
    fun makePreferred() {
        isPreferred = true
    }
}
</code></pre>
<p>the following JavaScript code will be generated</p>
<pre><code class="code _highlighted" data-lang="text/javascript">define('customerBL', ['kotlin'], function (Kotlin) {
  'use strict';
  var _ = Kotlin.defineRootPackage(null, /** @lends _ */ {
    Customer: Kotlin.createClass(null, function Customer(id, name, email) {
      this.id = id;
      this.name = name;
      this.email = email;
      this.isPreferred = false;
    }, /** @lends _.Customer.prototype */ {
      makePreferred: function () {
        this.isPreferred = true;
      }
    })
  });
  Kotlin.defineModule('customerBL', _);
  return _;
});
</code></pre>
<p>Assuming we have the following project layout</p>
<p><img alt="Project Structure AMD" src="/kotlin-web-site-ja/assets/images/tutorials/javascript/working-with-modules/project-structure-amd.png"/></p>
<p>we could define our <code>index.html</code> to load <code>require.js</code> along with <code>main.js</code> as the value of the <code>data-main</code> attribute</p>
<pre><code class="code _highlighted" data-lang="application/xml">&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Sample AMD&lt;/title&gt;
    &lt;script data-main="scripts/main"  src="scripts/require.js"&gt;&lt;/script&gt;
&lt;/head&gt;
</code></pre>
<p>The contents of our <code>main.js</code> would be:</p>
<pre><code class="code _highlighted" data-lang="text/javascript">requirejs.config({
    paths: {
        kotlin: 'out/lib/kotlin.js',
        customerBL: 'out/customerBL'
    }
});

requirejs(["customerBL"], function (customerBL) {
    console.log(customerBL)
});
</code></pre>
<p>With this, we can then access any of the functionality defined inside <code>customerBL</code>.</p>
<h2 id="using-commonjs">Using CommonJS</h2>
<p>In order to use Kotlin with node.js, we need to set the compiler option to use CommonJS. Once we do that, the output of the application
should be accessible using the node module system.</p>
<p>For instance, given</p>
<pre><code class="code _highlighted" data-lang="text/x-kotlin">class Customer(val id: Int, val name: String, val email: String) {
    var isPreferred = false
    fun makePreferred() {
        isPreferred = true
    }
}
</code></pre>
<p>the following JavaScript code will be generated</p>
<pre><code class="code _highlighted" data-lang="text/javascript">module.exports = function (Kotlin) {
  'use strict';
  var _ = Kotlin.defineRootPackage(null, /** @lends _ */ {
    Customer: Kotlin.createClass(null, function Customer(id, name, email) {
      this.id = id;
      this.name = name;
      this.email = email;
      this.isPreferred = false;
    }, /** @lends _.Customer.prototype */ {
      makePreferred: function () {
        this.isPreferred = true;
      }
    })
  });
  Kotlin.defineModule('customerBL', _);
  return _;
}(require('kotlin'));

</code></pre>
<p>The last line is invoking the function itself and passing as argument <code>kotlin</code>, which refers to the standard library. This can be obtained in one of two ways:</p>
<p><em>Local reference</em></p>
<p>When compiling, the compiler always outputs the kotlin.js file. The easiest way to reference this without having to refer to paths, is to set the output library folder for the compiler options 
to <code>node_modules</code>. This way, Node will automatically pick it up as it does an exhaustive search for files under these folders</p>
<p><img alt="Node Modules" src="/kotlin-web-site-ja/assets/images/tutorials/javascript/working-with-modules/node-modules.png"/></p>
<p><em>NPM Directory</em></p>
<p>The Kotlin standard library is available on <a href="https://www.npmjs.com/">npm</a> and we can simply include it in our <code>package.json</code> as a dependency.</p>
<pre><code class="code _highlighted" data-lang="application/json">{
  "name": "node-demo",
  "description": "A sample of using Kotlin with node.js",
  "version": "0.0.1",
  "dependencies": {
    "kotlin": "&gt;=1.0.4-eap-111"
  }
}
</code></pre>
<p>We can simply refer to any class or member function inside our node.js code by simply importing the module using <code>require</code>:</p>
<pre><code class="code _highlighted" data-lang="text/javascript">

var customerBL = require('./scripts/customerBL')

var customer = new customerBL.Customer(1, "Jane Smith", "jane.smith@company.com")

console.dir(customer)
customer.makePreferred()
console.dir(customer)
</code></pre>
<p>In this case, we've set the output of our compilation to the <code>scripts</code> folder. On running the application we should see the following output:</p>
<p><img alt="Output CommonJS" src="/kotlin-web-site-ja/assets/images/tutorials/javascript/working-with-modules/output-commonjs.png"/></p>

        </article>
    </div>



    <script src="/kotlin-web-site-ja/_assets/tutorials.js"></script>
    </div>

</div>

<footer role="contentinfo" class="global-footer">

    <div class="global-footer-terms">
        <div class="g-layout">

            <div class="terms-copyright">
                &copy; 2000&ndash;2016 JetBrains. All rights reserved
            </div>

            <div class="terms-sponsor">
                Sponsored and developed by <a href="http://jetbrains.com" class="sponsor sponsor_jetbrains" target="_blank">JetBrains</a>
            </div>
        </div>
    </div>

</footer></body>
</html>